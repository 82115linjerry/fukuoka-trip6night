<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>福岡戰術執行手冊</title>
    
    <!-- PWA Settings -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#ffffff">

    <!-- Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='background:%232563EB'%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='white' font-size='300' font-family='sans-serif' font-weight='bold'%3EF%3C/text%3E%3C/svg%3E">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='background:%232563EB'%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='white' font-size='300' font-family='sans-serif' font-weight='bold'%3EF%3C/text%3E%3C/svg%3E">
    <link rel="manifest" href='data:application/manifest+json,{"name":"福岡戰術","short_name":"福岡戰術","display":"standalone","start_url":".","background_color":"#ffffff","theme_color":"#ffffff","icons":[{"src":"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 512 512%27 style=%27background:%232563EB%27%3E%3Ctext x=%2750%25%27 y=%2750%25%27 dominant-baseline=%27middle%27 text-anchor=%27middle%27 fill=%27white%27 font-size=%27300%27 font-family=%27sans-serif%27 font-weight=%27bold%27%3EF%3C/text%3E%3C/svg%3E","sizes":"512x512","type":"image/svg+xml"}]}'>

    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { -webkit-tap-highlight-color: transparent; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        /* Safe area for iPhone notch/home bar */
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        /* Animation for AI typing */
        @keyframes blink { 50% { opacity: 0; } }
        .typing-dot { animation: blink 1.4s infinite both; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
    </style>
</head>
<body class="bg-gray-200 flex justify-center h-[100dvh] overflow-hidden">

    <div id="root" class="w-full h-full max-w-md bg-slate-50 shadow-2xl overflow-hidden relative"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icons (SVG Components) ---
        // Fixed: Wrapped adjacent elements in Fragments <></>
        const Icon = ({ name, size = 20, className = "" }) => {
            const icons = {
                MapPin: <><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></>,
                Calendar: <><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></>,
                CheckSquare: <><polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></>,
                CreditCard: <><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></>,
                MessageSquare: <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>,
                ShieldAlert: <><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></>,
                ChevronDown: <polyline points="6 9 12 15 18 9"/>,
                ChevronUp: <polyline points="18 15 12 9 6 15"/>,
                Navigation: <polygon points="3 11 22 2 13 21 11 13 3 11"/>,
                Utensils: <><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></>,
                ShoppingBag: <><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></>,
                Train: <><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/><line x1="2" y1="17" x2="22" y2="17"/></>,
                Send: <><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></>,
                Plus: <><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></>,
                Trash2: <><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></>,
                Home: <><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></>,
                User: <><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></>,
                Phone: <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>,
                Settings: <><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.18-.08a2 2 0 0 0-2 2v.44a2 2 0 0 0 2 2h.18a2 2 0 0 1 1.73 1l.25.43a2 2 0 0 1 0 2l-.08.18a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.18.08a2 2 0 0 0 2-2v-.44a2 2 0 0 0-2-2h-.18a2 2 0 0 1-1.73-1l-.25-.43a2 2 0 0 1 0-2l.08-.18a2 2 0 0 0-2-2zM12 22a10 10 0 1 1 10-10 10 10 0 0 1-10 10zm0-18a8 8 0 1 0 8 8 8 8 0 0 0-8-8z"/><circle cx="12" cy="12" r="3"/></>
            };

            return (
                <svg 
                    xmlns="http://www.w3.org/2000/svg" 
                    width={size} 
                    height={size} 
                    viewBox="0 0 24 24" 
                    fill="none" 
                    stroke="currentColor" 
                    strokeWidth="2" 
                    strokeLinecap="round" 
                    strokeLinejoin="round" 
                    className={className}
                >
                    {icons[name] || <circle cx="12" cy="12" r="10"/>}
                </svg>
            );
        };

        // --- Data ---
        const initialTripData = {
          itinerary: [
            {
              day: 1, date: "12/09 (週二)", theme: "初抵福地",
              tasks: [
                { id: 't1-1', time: "11:00", title: "桃園機場出發 (IT720)", type: "transport", note: "APP自助報到" },
                { id: 't1-2', time: "16:55", title: "抵達福岡機場", type: "transport", note: "開啟 VJW 截圖，保持隊形" },
                { id: 't1-3', time: "18:00", title: "前往飯店", type: "transport", note: "計程車首選 (約¥2,500)，A3出口搭乘" },
                { id: 't1-4', time: "20:00", title: "晚餐：博多祇園鉄なべ", type: "food", note: "排隊名店。備案：たんやHAKATA (牛舌)", map: "博多祇園鉄なべ" },
                { id: 't1-5', time: "21:30", title: "補給：MaxValu Express", type: "shopping", note: "買水、水果、早餐", map: "MaxValu Express Hakata Ekimae" }
              ]
            },
            {
              day: 2, date: "12/10 (週三)", theme: "新舊交融",
              tasks: [
                { id: 't2-1', time: "08:00", title: "早餐：Dacomecca", type: "food", note: "排隊王者，建議年輕組先去", map: "Dacomecca" },
                { id: 't2-2', time: "09:30", title: "櫛田神社 & 川端通", type: "sightseeing", note: "博多文化源頭", map: "Kushida Shrine" },
                { id: 't2-3', time: "10:15", title: "Full Full Hakata", type: "food", note: "明太子法國麵包", map: "Full Full Hakata" },
                { id: 't2-4', time: "12:00", title: "午餐：吉塚鰻魚屋", type: "food", note: "強烈建議預約！排隊需1hr+", map: "Yoshizuka Unagiya" },
                { id: 't2-5', time: "15:00", title: "Lalaport 福岡", type: "sightseeing", note: "1:1 鋼彈立像 (整點演出)", map: "LaLaport Fukuoka" },
                { id: 't2-6', time: "17:30", title: "晚餐：燒肉 大東園 本店", type: "food", note: "必須預約。備案：博多華味鳥", map: "Daitoen Honten" }
              ]
            },
            {
              day: 3, date: "12/11 (週四)", theme: "太宰府禪意",
              tasks: [
                { id: 't3-1', time: "10:00", title: "移動：巴士總站「旅人」號", type: "transport", note: "1F 11號月台，直達確保有位", map: "Hakata Bus Terminal" },
                { id: 't3-2', time: "11:00", title: "太宰府天滿宮 & 表參道", type: "sightseeing", note: "梅枝餅、星巴克、飛梅館", map: "Dazaifu Tenmangu" },
                { id: 't3-3', time: "12:30", title: "午餐：一蘭拉麵 太宰府店", type: "food", note: "特色五角碗", map: "Ichiran Dazaifu" },
                { id: 't3-4', time: "14:30", title: "光明禪寺", type: "sightseeing", note: "枯山水庭園，拜觀料¥300現金", map: "Komyozenji" },
                { id: 't3-5', time: "17:00", title: "Pain Stock (天神)", type: "food", note: "天神中央公園店", map: "stock" },
                { id: 't3-6', time: "19:00", title: "晚餐：麵屋兼虎", type: "food", note: "沾麵名店。備案：大砲拉麵", map: "Menya Kanetora Tenjin" }
              ]
            },
            {
              day: 4, date: "12/12 (週五)", theme: "港都懷舊",
              tasks: [
                { id: 't4-1', time: "09:00", title: "移動：新幹線 (博多>小倉)", type: "transport", note: "速度戰術！節省體力", map: "Hakata Station" },
                { id: 't4-2', time: "10:30", title: "門司港懷舊區", type: "sightseeing", note: "舊三井俱樂部、藍翼橋", map: "Mojiko Retro" },
                { id: 't4-3', time: "12:30", title: "午餐：伽哩本舖", type: "food", note: "燒咖哩，推薦窗邊", map: "Curry Honpo Mojiko" },
                { id: 't4-4', time: "13:30", title: "唐戶市場 / 門司港午茶", type: "sightseeing", note: "方案A: MILKHALL布丁 / 方案B: 聯絡船+海底隧道", map: "Karato Market" },
                { id: 't4-5', time: "17:00", title: "晚餐：但馬屋 / 小林養雞", type: "food", note: "回到博多用餐", map: "Hakata Station" }
              ]
            },
            {
              day: 5, date: "12/13 (週六)", theme: "博多美食精髓",
              tasks: [
                { id: 't5-1', time: "08:30", title: "早餐：食堂 おわん", type: "food", note: "精緻日式朝食", map: "Shokudo Owan" },
                { id: 't5-2', time: "12:00", title: "午餐：とんかつわか葉", type: "food", note: "炸豬排。11:15前要排隊！", map: "Tonkatsu Wakaba" },
                { id: 't5-3', time: "15:00", title: "博多運河城", type: "sightseeing", note: "噴水秀、購物", map: "Canal City Hakata" },
                { id: 't5-4', time: "17:30", title: "晚餐：華味鳥 / 前田屋", type: "food", note: "分組行動：清淡 vs 濃郁。需預約", map: "Hakata Hanamidori" }
              ]
            },
            {
              day: 6, date: "12/14 (週日)", theme: "福岡生活光譜",
              tasks: [
                { id: 't6-1', time: "09:00", title: "麵包巡禮：Amam Dacotan", type: "food", note: "六本松。備案：Matsu Pan", map: "Amam Dacotan" },
                { id: 't6-2', time: "10:30", title: "大濠公園 & 美術館", type: "sightseeing", note: "湖畔享用麵包", map: "Ohori Park" },
                { id: 't6-3', time: "14:00", title: "午餐：魚忠", type: "food", note: "CP值高海鮮定食", map: "Uochu" },
                { id: 't6-4', time: "15:00", title: "藥院選物 & Coffee County", type: "shopping", note: "B・B・B POTTERS", map: "B・B・B POTTERS" },
                { id: 't6-5', time: "17:00", title: "福岡塔 & 西新", type: "sightseeing", note: "百道海濱夜景、蜂樂饅頭", map: "Fukuoka Tower" },
                { id: 't6-6', time: "19:00", title: "晚餐：小林養雞 (西新店)", type: "food", note: "居酒屋", map: "Kobayashi Youkei Nishijin" }
              ]
            },
            {
              day: 7, date: "12/15 (週一)", theme: "完美歸途",
              tasks: [
                { id: 't7-1', time: "09:00", title: "退房 & 行李寄放", type: "transport", note: "LIVEIL 櫃台" },
                { id: 't7-2', time: "11:00", title: "博多站最後衝刺", type: "shopping", note: "阪急B1/AMU。伴手禮：福砂屋、努努雞", map: "Hakata Hankyu" },
                { id: 't7-3', time: "12:00", title: "午餐：博多麵街道", type: "food", note: "Shin-Shin 或 海鳴", map: "Hakata Noodle Street" },
                { id: 't7-4', time: "14:00", title: "搭計程車前往機場", type: "transport", note: "回飯店取行李直奔國際線" },
                { id: 't7-5', time: "15:15", title: "出境程序 (IT721)", type: "transport", note: "17:55起飛。安檢人多請提早", map: "Fukuoka Airport International Terminal" }
              ]
            }
          ]
        };

        const initialChecklist = [
          { id: 'c1', text: 'Visit Japan Web QR Code (黃色入境)', done: false, cat: 'document' },
          { id: 'c2', text: 'Visit Japan Web QR Code (藍色海關)', done: false, cat: 'document' },
          { id: 'c3', text: '護照 (檢查效期)', done: false, cat: 'document' },
          { id: 'c4', text: '機票、訂房憑證 (雲端+離線備份)', done: false, cat: 'document' },
          { id: 'c5', text: '海外旅遊保險單', done: false, cat: 'document' },
          { id: 'c6', text: '發熱衣 (Heattech, 非純棉)', done: false, cat: 'clothing' },
          { id: 'c7', text: '洋蔥式中層 (羊毛衫/羽絨背心)', done: false, cat: 'clothing' },
          { id: 'c8', text: '防風抗水外套', done: false, cat: 'clothing' },
          { id: 'c9', text: '保暖配件 (圍巾、手套、毛帽)', done: false, cat: 'clothing' },
          { id: 'c10', text: '現金 (每人約 ¥50,000)', done: false, cat: 'money' },
          { id: 'c11', text: '高回饋信用卡 (百貨/飯店用)', done: false, cat: 'money' },
          { id: 'c12', text: 'IC卡 (Suica/ICOCA) ', done: false, cat: 'money' },
          { id: 'c13', text: '常備藥 (感冒/胃藥/痠痛貼布)', done: false, cat: 'other' },
          { id: 'c14', text: '行動電源 & 充電線', done: false, cat: 'other' },
        ];

        // --- Context for AI ---
        const MANUAL_CONTEXT = `
        福岡冬日家庭旅行戰術執行手冊 (12/9-12/15):
        1. 核心理念: 洋蔥式穿搭(3-13度), 數位通關截圖備份, 備案(Plan B), 計程車保存體力。
        2. 飯店: LIVEIL HAKATAEKIMAE (博多駅前4-31-11)。
        3. 行程摘要:
           - Day1: 機場搭計程車到飯店, 晚餐博多祇園鉄なべ(備案:たんやHAKATA), 超市MaxValu採買。
           - Day2: 早餐Dacomecca, 櫛田神社, Full Full明太子法棍, 午餐吉塚鰻魚屋, 下午Lalaport鋼彈, 晚餐大東園燒肉(備案:華味鳥)。
           - Day3: 太宰府(旅人號巴士), 天滿宮, 一蘭, 光明禪寺, 晚餐麵屋兼虎(備案:大砲拉麵)。
           - Day4: 門司港(新幹線到小倉轉車), 燒咖哩, 唐戶市場, 晚餐但馬屋壽喜燒。
           - Day5: 早餐食堂おわん, 午餐とんかつわか葉炸豬排, 運河城, 晚餐華味鳥/前田屋牛腸鍋。
           - Day6: 六本松麵包Amam Dacotan, 大濠公園, 午餐魚忠, 福岡塔夜景, 晚餐小林養雞。
           - Day7: 退房, 博多站採買(努努雞,福砂屋), 午餐Shin-Shin拉麵, 計程車去機場。
        4. 戰術:
           - 穿搭: 發熱衣(非純棉)+中層+防風外套+圍巾手套。
           - 交通: 有行李或累了就搭計程車。
           - 緊急: 護照遺失找台北駐福岡辦事處。急診找福岡市急患診療中心。
        `;

        // --- Simulated AI Knowledge Base (Fallback) ---
        const aiKnowledge = [
            { keywords: ['穿', '冷', '天氣', '衣服', '熱', '洋蔥'], 
              responses: [
                  "根據手冊，這幾天溫差大（3-13度）。請務必採用「3+1洋蔥式穿搭」：發熱衣（勿穿純棉）、中層羊毛/羽絨、外層防風外套。圍巾手套不可少！",
                  "這天氣最怕進出室內外溫差。建議裡面穿薄一點的發熱衣，外面加件好脫的羽絨背心，進有暖氣的店家才不會熱到流汗。"
              ] 
            },
            { keywords: ['吃', '餓', '餐廳', '美食', '飯'], 
              responses: [
                  "餓了嗎？如果目標名店（如鉄なべ）排隊超過 45 分鐘，請執行「戰術撤退」！直接開 Google Maps 找附近的居酒屋或定食。",
                  "想吃好料嗎？午餐推薦「吉塚鰻魚屋」，但沒預約可能要排很久。備案可以考慮附近的百貨公司樓上。"
              ] 
            }
        ];

        const defaultResponses = [
            "收到。如果要買伴手禮，努努雞和福砂屋長崎蛋糕是博多車站的必買清單喔！",
            "指揮官，如果走累了，隨便找間咖啡廳休息一下吧。旅行是為了放鬆，不是行軍喔！"
        ];

        // --- Sub-Components ---

        const AIChat = ({ apiKey }) => {
            const [messages, setMessages] = useState([
                { id: 1, sender: 'ai', text: '指揮官您好！我是您的戰術 AI。' + (apiKey ? '已連線 Google Gemini 衛星網路，請隨意發問！' : '目前使用離線資料庫。若需更強大功能，請至首頁輸入 API Key。') }
            ]);
            const [input, setInput] = useState('');
            const [isTyping, setIsTyping] = useState(false);
            const scrollRef = useRef(null);

            useEffect(() => {
                if (scrollRef.current) scrollRef.current.scrollTop = scrollRef.current.scrollHeight;
            }, [messages, isTyping]);

            const handleSend = async () => {
                if (!input.trim()) return;
                const userText = input;
                const userMsg = { id: Date.now(), sender: 'user', text: userText };
                
                setMessages(prev => [...prev, userMsg]);
                setInput('');
                setIsTyping(true);

                if (apiKey) {
                    // --- REAL AI MODE (Gemini) with Auto-Fallback ---
                    // Try 1.5-flash first, then 1.5-flash-latest, then gemini-pro
                    const modelsToTry = ["gemini-1.5-flash", "gemini-1.5-flash-latest", "gemini-pro"];
                    let success = false;
                    let aiResponse = "";

                    for (const model of modelsToTry) {
                        try {
                            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    contents: [{
                                        parts: [{ text: `Context: ${MANUAL_CONTEXT} \n\n User Question: ${userText} \n\n Please answer in Traditional Chinese as a helpful travel assistant. Keep it concise.` }]
                                    }]
                                })
                            });
                            
                            const data = await response.json();
                            
                            if (data.error) {
                                // If error, throw to catch block to try next model
                                console.log(`Model ${model} failed:`, data.error.message);
                                throw new Error(data.error.message);
                            }

                            aiResponse = data.candidates[0].content.parts[0].text;
                            success = true;
                            break; // Success! Stop trying other models.

                        } catch (error) {
                            // Continue to next model
                        }
                    }

                    setIsTyping(false);
                    if (success) {
                        setMessages(prev => [...prev, { id: Date.now() + 1, sender: 'ai', text: aiResponse }]);
                    } else {
                        setMessages(prev => [...prev, { id: Date.now() + 1, sender: 'ai', text: `連線錯誤：無法連接任何 AI 模型 (已嘗試 ${modelsToTry.join(', ')})。請檢查 API Key 是否正確。已暫時切換回離線模式。` }]);
                    }

                } else {
                    // --- SIMULATED MODE (Fallback) ---
                    setTimeout(() => {
                        const q = userText.toLowerCase();
                        let response = "";
                        const matchedCategory = aiKnowledge.find(cat => cat.keywords.some(k => q.includes(k)));
                        if (matchedCategory) {
                            response = matchedCategory.responses[Math.floor(Math.random() * matchedCategory.responses.length)];
                        } else {
                            response = defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
                        }
                        setIsTyping(false);
                        setMessages(prev => [...prev, { id: Date.now() + 1, sender: 'ai', text: response }]);
                    }, 800);
                }
            };

            return (
                <div className="flex flex-col h-full bg-slate-50">
                    <div className="flex-1 overflow-y-auto p-4 space-y-4" ref={scrollRef}>
                        {messages.map(m => (
                            <div key={m.id} className={`flex ${m.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
                                <div className={`max-w-[85%] p-3.5 rounded-2xl text-sm leading-relaxed shadow-sm ${
                                    m.sender === 'user' 
                                        ? 'bg-blue-600 text-white rounded-br-none' 
                                        : 'bg-white border border-slate-200 text-slate-800 rounded-bl-none'
                                }`}>
                                    {m.text}
                                </div>
                            </div>
                        ))}
                        {isTyping && (
                            <div className="flex justify-start">
                                <div className="bg-white border border-slate-200 p-4 rounded-2xl rounded-bl-none shadow-sm flex gap-1 items-center">
                                    <div className="w-1.5 h-1.5 bg-slate-400 rounded-full typing-dot"></div>
                                    <div className="w-1.5 h-1.5 bg-slate-400 rounded-full typing-dot"></div>
                                    <div className="w-1.5 h-1.5 bg-slate-400 rounded-full typing-dot"></div>
                                </div>
                            </div>
                        )}
                    </div>
                    <div className="p-3 bg-white border-t border-slate-200 flex gap-2">
                        <input 
                            className="flex-1 bg-slate-100 rounded-full px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" 
                            placeholder={apiKey ? "已連線 Gemini..." : "離線模式 (請至首頁設定Key)"}
                            value={input} 
                            onChange={(e) => setInput(e.target.value)} 
                            onKeyDown={(e) => e.key === 'Enter' && handleSend()} 
                        />
                        <button 
                            onClick={handleSend} 
                            className={`p-2 rounded-full active:scale-95 transition shadow-sm text-white ${apiKey ? 'bg-gradient-to-r from-blue-500 to-purple-600' : 'bg-slate-600'}`}
                        >
                            <Icon name="Send" size={18} />
                        </button>
                    </div>
                </div>
            );
        };

        const ExpenseTracker = () => {
            const [expenses, setExpenses] = useState(() => {
                const saved = localStorage.getItem('fukuoka_expenses');
                return saved ? JSON.parse(saved) : [
                    { id: 1, item: '計程車 (機場-飯店)', amount: 2500, cat: 'transport' },
                    { id: 2, item: '便利商店水/早餐', amount: 1200, cat: 'food' },
                ];
            });
            const [newItem, setNewItem] = useState('');
            const [newAmount, setNewAmount] = useState('');
            const [newCat, setNewCat] = useState('food');

            useEffect(() => {
                localStorage.setItem('fukuoka_expenses', JSON.stringify(expenses));
            }, [expenses]);

            const addExpense = () => {
                if (!newItem || !newAmount) return;
                setExpenses([...expenses, { id: Date.now(), item: newItem, amount: parseInt(newAmount), cat: newCat }]);
                setNewItem('');
                setNewAmount('');
            };

            const deleteExpense = (id) => {
                if(confirm('確定要刪除這筆消費紀錄嗎？')) {
                    setExpenses(prev => prev.filter(item => item.id !== id));
                }
            };

            const total = expenses.reduce((sum, ex) => sum + ex.amount, 0);

            return (
                <div className="p-4 space-y-6 bg-slate-50 h-full overflow-y-auto">
                    <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                        <div className="text-slate-500 text-sm mb-1">總支出 (日圓)</div>
                        <div className="text-4xl font-bold text-slate-800">¥ {total.toLocaleString()}</div>
                    </div>
                    <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200 space-y-3">
                        <h3 className="font-bold text-slate-700 flex items-center gap-2"><Icon name="Plus" size={18} /> 新增消費</h3>
                        <div className="grid grid-cols-2 gap-2">
                            <input placeholder="項目" className="col-span-2 p-2 bg-slate-50 rounded-lg border border-slate-200 text-sm" value={newItem} onChange={e => setNewItem(e.target.value)} />
                            <input type="number" placeholder="金額" className="p-2 bg-slate-50 rounded-lg border border-slate-200 text-sm" value={newAmount} onChange={e => setNewAmount(e.target.value)} />
                            <select className="p-2 bg-slate-50 rounded-lg border border-slate-200 text-sm" value={newCat} onChange={e => setNewCat(e.target.value)}>
                                <option value="food">餐飲</option>
                                <option value="transport">交通</option>
                                <option value="shopping">購物</option>
                                <option value="other">其他</option>
                            </select>
                        </div>
                        <button onClick={addExpense} className="w-full bg-slate-800 text-white py-2 rounded-lg font-medium text-sm active:scale-95 transition">紀錄</button>
                    </div>
                    <div className="space-y-2 pb-20">
                        <h3 className="font-bold text-slate-700 px-1">消費明細</h3>
                        {expenses.length === 0 && <div className="text-center text-slate-400 text-sm py-4">暫無消費紀錄</div>}
                        {expenses.slice().reverse().map(ex => (
                            <div key={ex.id} className="flex justify-between items-center bg-white p-3 rounded-xl border border-slate-100 group">
                                <div className="flex items-center gap-3 overflow-hidden">
                                    <div className={`p-2 rounded-full shrink-0 ${ex.cat === 'food' ? 'bg-orange-100 text-orange-600' : ex.cat === 'transport' ? 'bg-blue-100 text-blue-600' : ex.cat === 'shopping' ? 'bg-pink-100 text-pink-600' : 'bg-gray-100 text-gray-600'}`}>
                                        {ex.cat === 'food' && <Icon name="Utensils" size={16} />}
                                        {ex.cat === 'transport' && <Icon name="Train" size={16} />}
                                        {ex.cat === 'shopping' && <Icon name="ShoppingBag" size={16} />}
                                        {ex.cat === 'other' && <Icon name="CreditCard" size={16} />}
                                    </div>
                                    <div className="min-w-0">
                                        <div className="text-sm font-medium text-slate-800 truncate">{ex.item}</div>
                                        <div className="text-xs text-slate-400">{ex.cat === 'food' ? '餐飲' : ex.cat === 'transport' ? '交通' : ex.cat === 'shopping' ? '購物' : '其他'}</div>
                                    </div>
                                </div>
                                <div className="flex items-center gap-3 pl-2 shrink-0">
                                    <div className="font-bold text-slate-700">¥{ex.amount.toLocaleString()}</div>
                                    <button onClick={() => deleteExpense(ex.id)} className="p-1.5 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition"><Icon name="Trash2" size={16} /></button>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const ItineraryDay = ({ dayData, onDeleteTask, onAddTask }) => {
            const [isOpen, setIsOpen] = useState(false);
            const [isAdding, setIsAdding] = useState(false);
            const [newTask, setNewTask] = useState({ time: '', title: '', note: '', type: 'sightseeing' });

            useEffect(() => { if (dayData.day === 1) setIsOpen(true); }, [dayData.day]);

            const handleSave = () => {
                if (!newTask.title) return;
                onAddTask(dayData.day, { ...newTask, id: 't' + Date.now() });
                setNewTask({ time: '', title: '', note: '', type: 'sightseeing' });
                setIsAdding(false);
            };

            return (
                <div className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden transition-all duration-300">
                    <div onClick={() => setIsOpen(!isOpen)} className="p-4 flex items-center justify-between cursor-pointer bg-slate-50 hover:bg-slate-100 transition">
                        <div className="flex items-center gap-4">
                            <div className="bg-slate-800 text-white w-10 h-10 rounded-xl flex items-center justify-center font-bold text-lg">{dayData.day}</div>
                            <div>
                                <div className="text-xs text-slate-500 font-medium">{dayData.date}</div>
                                <div className="text-slate-800 font-bold">{dayData.theme}</div>
                            </div>
                        </div>
                        <Icon name={isOpen ? "ChevronUp" : "ChevronDown"} className="text-slate-400" />
                    </div>
                    {isOpen && (
                        <div className="p-4 space-y-4 border-t border-slate-100">
                            {dayData.tasks.length === 0 && <div className="text-center text-slate-400 text-sm py-2">無行程</div>}
                            {dayData.tasks.map((task, idx) => (
                                <div key={task.id} className="flex gap-3 relative group">
                                    {idx !== dayData.tasks.length - 1 && <div className="absolute left-[19px] top-8 bottom-[-16px] w-[2px] bg-slate-100"></div>}
                                    <div className={`mt-1 min-w-[40px] h-[40px] rounded-full flex items-center justify-center z-10 ${task.type === 'food' ? 'bg-orange-50 text-orange-500' : task.type === 'transport' ? 'bg-blue-50 text-blue-500' : task.type === 'shopping' ? 'bg-pink-50 text-pink-500' : 'bg-green-50 text-green-500'}`}>
                                        {task.type === 'food' && <Icon name="Utensils" size={18} />}
                                        {task.type === 'transport' && <Icon name="Train" size={18} />}
                                        {task.type === 'shopping' && <Icon name="ShoppingBag" size={18} />}
                                        {task.type === 'sightseeing' && <Icon name="MapPin" size={18} />}
                                    </div>
                                    <div className="flex-1 pb-2">
                                        <div className="flex justify-between items-start">
                                            <div>
                                                <span className="text-xs font-bold text-blue-600 bg-blue-50 px-2 py-0.5 rounded-md mr-2">{task.time}</span>
                                                <span className="font-bold text-slate-800">{task.title}</span>
                                            </div>
                                            <button onClick={() => onDeleteTask(dayData.day, task.id)} className="text-slate-300 hover:text-red-500 p-1"><Icon name="Trash2" size={16} /></button>
                                        </div>
                                        <div className="text-sm text-slate-500 mt-1 leading-relaxed">{task.note}</div>
                                        {task.map && (
                                            <a href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(task.map + " Fukuoka")}`} target="_blank" className="mt-2 inline-flex items-center gap-1 text-xs font-medium text-blue-600 hover:bg-blue-50 px-2 py-1 rounded-lg border border-blue-100 transition">
                                                <Icon name="Navigation" size={12} /> 導航
                                            </a>
                                        )}
                                    </div>
                                </div>
                            ))}
                            
                            {/* Add Task UI */}
                            {!isAdding ? (
                                <button onClick={() => setIsAdding(true)} className="w-full py-2 flex items-center justify-center gap-2 text-sm font-bold text-blue-600 bg-blue-50 rounded-xl hover:bg-blue-100 transition"><Icon name="Plus" size={16} /> 新增行程</button>
                            ) : (
                                <div className="bg-slate-50 p-3 rounded-xl border border-slate-200 space-y-3 animate-pulse-once">
                                    <div className="flex gap-2">
                                        <input placeholder="時間" className="w-1/3 p-2 text-sm border rounded-lg" value={newTask.time} onChange={e => setNewTask({...newTask, time: e.target.value})} />
                                        <select className="w-1/3 p-2 text-sm border rounded-lg" value={newTask.type} onChange={e => setNewTask({...newTask, type: e.target.value})}>
                                            <option value="sightseeing">景點</option>
                                            <option value="food">美食</option>
                                            <option value="shopping">購物</option>
                                            <option value="transport">交通</option>
                                        </select>
                                    </div>
                                    <input placeholder="行程標題" className="w-full p-2 text-sm border rounded-lg" value={newTask.title} onChange={e => setNewTask({...newTask, title: e.target.value})} />
                                    <input placeholder="備註 (選填)" className="w-full p-2 text-sm border rounded-lg" value={newTask.note} onChange={e => setNewTask({...newTask, note: e.target.value})} />
                                    <div className="flex gap-2">
                                        <button onClick={() => setIsAdding(false)} className="flex-1 py-2 text-slate-500 text-sm font-bold bg-white border border-slate-200 rounded-lg">取消</button>
                                        <button onClick={handleSave} className="flex-1 py-2 text-white text-sm font-bold bg-blue-600 rounded-lg shadow-sm">確認新增</button>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        const ChecklistTab = ({ items, toggleItem }) => {
            const cats = { document: "必備文件", clothing: "穿搭防禦", money: "財務準備", other: "雜項補給" };
            return (
                <div className="h-full overflow-y-auto p-4 pb-20 space-y-6">
                    <div className="bg-slate-800 text-white p-6 rounded-2xl shadow-md">
                        <h2 className="text-xl font-bold mb-2">出擊準備清單</h2>
                        <p className="text-slate-300 text-sm">確保裝備齊全，降低變數風險。</p>
                        <div className="mt-4 flex gap-4 text-sm">
                            <div><span className="text-2xl font-bold">{items.filter(i => i.done).length}</span><span className="text-slate-400 ml-1">完成</span></div>
                            <div><span className="text-2xl font-bold">{items.length}</span><span className="text-slate-400 ml-1">總項</span></div>
                        </div>
                    </div>
                    {Object.entries(cats).map(([key, label]) => (
                        <div key={key}>
                            <h3 className="text-slate-500 font-bold text-sm mb-2 px-1">{label}</h3>
                            <div className="bg-white rounded-xl border border-slate-200 divide-y divide-slate-100">
                                {items.filter(i => i.cat === key).map(item => (
                                    <div key={item.id} onClick={() => toggleItem(item.id)} className="p-4 flex items-center gap-3 cursor-pointer hover:bg-slate-50 active:bg-slate-100 transition">
                                        <div className={`w-6 h-6 rounded-md border-2 flex items-center justify-center transition ${item.done ? 'bg-blue-600 border-blue-600' : 'border-slate-300'}`}>
                                            {item.done && <Icon name="CheckSquare" size={16} className="text-white" />}
                                        </div>
                                        <span className={`text-sm font-medium transition ${item.done ? 'text-slate-400 line-through' : 'text-slate-800'}`}>{item.text}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    ))}
                </div>
            );
        };

        const HomeTab = ({ leaderInfo, setLeaderInfo, setActiveTab, apiKey, setApiKey }) => {
            const [isEditing, setIsEditing] = useState(false);
            const [tempName, setTempName] = useState(leaderInfo.name);
            const [tempPhone, setTempPhone] = useState(leaderInfo.phone);
            const [tempLine, setTempLine] = useState(leaderInfo.line);
            const [tempKey, setTempKey] = useState(apiKey);

            const saveInfo = () => {
                setLeaderInfo({ name: tempName, phone: tempPhone, line: tempLine });
                setApiKey(tempKey);
                setIsEditing(false);
            };

            return (
                <div className="h-full overflow-y-auto pb-20 bg-slate-50">
                    <div className="bg-slate-900 text-white p-8 rounded-b-[2.5rem] shadow-xl relative overflow-hidden">
                        <div className="absolute top-0 right-0 w-64 h-64 bg-blue-600 rounded-full blur-[80px] opacity-20 -mr-16 -mt-16"></div>
                        <div className="relative z-10">
                            <div className="inline-block px-3 py-1 bg-blue-900/50 rounded-full text-blue-300 text-xs font-bold mb-4 border border-blue-800">2024.12.09 - 12.15</div>
                            <h1 className="text-3xl font-black mb-2 tracking-tight">福岡冬日<br/>戰術執行手冊</h1>
                            <p className="text-slate-400 text-sm">Fukuoka Tactical Field Manual</p>
                        </div>
                    </div>
                    <div className="p-5 space-y-6 -mt-8 relative z-20">
                        <div className="bg-white p-5 rounded-2xl shadow-sm border border-slate-100">
                            <div className="flex justify-between items-start mb-4">
                                <h3 className="font-bold text-slate-800 flex items-center gap-2"><Icon name="User" size={18} className="text-blue-600"/> 領隊資訊</h3>
                                <button onClick={() => isEditing ? saveInfo() : setIsEditing(true)} className="text-xs font-bold text-blue-600 bg-blue-50 px-3 py-1.5 rounded-full">{isEditing ? '儲存' : '編輯'}</button>
                            </div>
                            {isEditing ? (
                                <div className="space-y-3">
                                    <input placeholder="領隊姓名" value={tempName} onChange={(e) => setTempName(e.target.value)} className="w-full p-2 bg-slate-50 border rounded-lg text-sm" />
                                    <input placeholder="手機號碼" value={tempPhone} onChange={(e) => setTempPhone(e.target.value)} className="w-full p-2 bg-slate-50 border rounded-lg text-sm" />
                                    <input placeholder="Line ID" value={tempLine} onChange={(e) => setTempLine(e.target.value)} className="w-full p-2 bg-slate-50 border rounded-lg text-sm" />
                                </div>
                            ) : (
                                <div className="space-y-3">
                                    <div className="flex items-center gap-3">
                                        <div className="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 font-bold">{leaderInfo.name ? leaderInfo.name[0] : "L"}</div>
                                        <div>
                                            <div className="font-bold text-slate-800">{leaderInfo.name || "未設定領隊"}</div>
                                            <div className="text-xs text-slate-400">主要聯絡人</div>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-3 mt-2">
                                        <div className="bg-slate-50 p-3 rounded-xl flex flex-col gap-1"><span className="text-xs text-slate-400">手機</span><span className="font-mono font-bold text-slate-700">{leaderInfo.phone || "--"}</span></div>
                                        <div className="bg-slate-50 p-3 rounded-xl flex flex-col gap-1"><span className="text-xs text-slate-400">Line ID</span><span className="font-mono font-bold text-slate-700">{leaderInfo.line || "--"}</span></div>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* API Key Setting Section */}
                        <div className="bg-white p-5 rounded-2xl shadow-sm border border-slate-100">
                            <h3 className="font-bold text-slate-800 flex items-center gap-2 mb-3"><Icon name="Settings" size={18} className="text-purple-600"/> API 設定 (AI 升級)</h3>
                            {isEditing ? (
                                <div>
                                    <p className="text-xs text-slate-400 mb-2">輸入 Google Gemini API Key 以啟用完整 AI 功能。</p>
                                    <input 
                                        type="password"
                                        placeholder="貼上 API Key" 
                                        value={tempKey} 
                                        onChange={(e) => setTempKey(e.target.value)}
                                        className="w-full p-2 bg-slate-50 border rounded-lg text-sm font-mono"
                                    />
                                </div>
                            ) : (
                                <div className="flex items-center justify-between bg-slate-50 p-3 rounded-xl">
                                    <span className="text-sm font-medium text-slate-600">Google Gemini</span>
                                    <span className={`text-xs font-bold px-2 py-1 rounded ${apiKey ? 'bg-green-100 text-green-600' : 'bg-gray-200 text-gray-500'}`}>
                                        {apiKey ? '已連線' : '未設定'}
                                    </span>
                                </div>
                            )}
                        </div>

                        <div className="grid grid-cols-2 gap-3">
                            <button onClick={() => setActiveTab('itinerary')} className="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex flex-col items-center gap-2 hover:bg-slate-50 transition">
                                <div className="w-10 h-10 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center"><Icon name="Calendar" size={20} /></div>
                                <span className="font-bold text-slate-700 text-sm">行程總覽</span>
                            </button>
                            <button onClick={() => setActiveTab('checklist')} className="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex flex-col items-center gap-2 hover:bg-slate-50 transition">
                                <div className="w-10 h-10 rounded-full bg-green-100 text-green-600 flex items-center justify-center"><Icon name="CheckSquare" size={20} /></div>
                                <span className="font-bold text-slate-700 text-sm">準備清單</span>
                            </button>
                        </div>
                        <div className="bg-orange-50 p-4 rounded-2xl border border-orange-100">
                            <h3 className="font-bold text-orange-800 mb-2 flex items-center gap-2"><Icon name="ShieldAlert" size={16}/> 緊急提示</h3>
                            <p className="text-sm text-orange-700 leading-relaxed">若遇突發狀況，請優先保持冷靜。領隊應立即確認全員位置，並參考手冊中的「應急預案」行動。</p>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            const [activeTab, setActiveTab] = useState('home');
            
            // Load state from localStorage or use defaults
            const [itinerary, setItinerary] = useState(() => {
                const saved = localStorage.getItem('fukuoka_itinerary');
                return saved ? JSON.parse(saved) : initialTripData.itinerary;
            });
            const [checklist, setChecklist] = useState(() => {
                const saved = localStorage.getItem('fukuoka_checklist');
                return saved ? JSON.parse(saved) : initialChecklist;
            });
            const [leaderInfo, setLeaderInfo] = useState(() => {
                const saved = localStorage.getItem('fukuoka_leader');
                return saved ? JSON.parse(saved) : { name: '', phone: '', line: '' };
            });
            const [apiKey, setApiKey] = useState(() => {
                return localStorage.getItem('fukuoka_api_key') || '';
            });

            // Persist changes
            useEffect(() => { localStorage.setItem('fukuoka_itinerary', JSON.stringify(itinerary)); }, [itinerary]);
            useEffect(() => { localStorage.setItem('fukuoka_checklist', JSON.stringify(checklist)); }, [checklist]);
            useEffect(() => { localStorage.setItem('fukuoka_leader', JSON.stringify(leaderInfo)); }, [leaderInfo]);
            useEffect(() => { localStorage.setItem('fukuoka_api_key', apiKey); }, [apiKey]);

            const handleDeleteTask = (dayNum, taskId) => {
                if (window.confirm("確定要刪除這個行程嗎？")) {
                    setItinerary(prev => prev.map(day => day.day === dayNum ? { ...day, tasks: day.tasks.filter(t => t.id !== taskId) } : day));
                }
            };

            const handleAddTask = (dayNum, newTask) => {
                setItinerary(prev => prev.map(day => {
                    if (day.day === dayNum) {
                        const updatedTasks = [...day.tasks, newTask];
                        // Sort by time
                        return { 
                            ...day, 
                            tasks: updatedTasks.sort((a, b) => a.time.localeCompare(b.time))
                        };
                    }
                    return day;
                }));
            };

            const toggleChecklist = (id) => {
                setChecklist(prev => prev.map(item => item.id === id ? { ...item, done: !item.done } : item));
            };

            return (
                <div className="flex flex-col h-full font-sans text-slate-900">
                    {activeTab !== 'home' && (
                        <div className="bg-white px-5 py-4 border-b border-slate-200 flex justify-between items-center z-10 sticky top-0">
                            <div>
                                <h1 className="font-black text-lg text-slate-800 tracking-tight">FUKUOKA <span className="text-blue-600">TACTICS</span></h1>
                                <p className="text-xs text-slate-400 font-medium tracking-wide">冬日家庭旅行執行手冊</p>
                            </div>
                            <button onClick={() => setActiveTab('home')} className="bg-slate-100 p-2 rounded-full text-slate-600 hover:bg-slate-200"><Icon name="Home" size={18} /></button>
                        </div>
                    )}

                    <div className="flex-1 overflow-hidden relative">
                        {activeTab === 'home' && <HomeTab leaderInfo={leaderInfo} setLeaderInfo={setLeaderInfo} setActiveTab={setActiveTab} apiKey={apiKey} setApiKey={setApiKey} />}
                        {activeTab === 'itinerary' && <div className="h-full overflow-y-auto p-4 space-y-4 pb-32">{itinerary.map(day => <ItineraryDay key={day.day} dayData={day} onDeleteTask={handleDeleteTask} onAddTask={handleAddTask} />)}</div>}
                        {activeTab === 'checklist' && <ChecklistTab items={checklist} toggleItem={toggleChecklist} />}
                        {activeTab === 'wallet' && <ExpenseTracker />}
                        {activeTab === 'ai' && <AIChat apiKey={apiKey} />}
                    </div>

                    {/* Floating Bottom Nav - Moves up to avoid ads/browser bars */}
                    <div className="fixed bottom-6 left-4 right-4 bg-white/95 backdrop-blur-md border border-slate-200 rounded-2xl shadow-2xl px-4 py-3 flex justify-between items-center z-50">
                        <button onClick={() => setActiveTab('home')} className={`flex flex-col items-center gap-1 transition min-w-[50px] ${activeTab === 'home' ? 'text-blue-600 scale-105' : 'text-slate-400'}`}><Icon name="Home" size={24} strokeWidth={activeTab === 'home' ? 2.5 : 2} /><span className="text-[10px] font-bold">首頁</span></button>
                        <button onClick={() => setActiveTab('itinerary')} className={`flex flex-col items-center gap-1 transition min-w-[50px] ${activeTab === 'itinerary' ? 'text-blue-600 scale-105' : 'text-slate-400'}`}><Icon name="Calendar" size={24} strokeWidth={activeTab === 'itinerary' ? 2.5 : 2} /><span className="text-[10px] font-bold">行程</span></button>
                        <button onClick={() => setActiveTab('checklist')} className={`flex flex-col items-center gap-1 transition min-w-[50px] ${activeTab === 'checklist' ? 'text-blue-600 scale-105' : 'text-slate-400'}`}><Icon name="CheckSquare" size={24} strokeWidth={activeTab === 'checklist' ? 2.5 : 2} /><span className="text-[10px] font-bold">清單</span></button>
                        <button onClick={() => setActiveTab('wallet')} className={`flex flex-col items-center gap-1 transition min-w-[50px] ${activeTab === 'wallet' ? 'text-blue-600 scale-105' : 'text-slate-400'}`}><Icon name="CreditCard" size={24} strokeWidth={activeTab === 'wallet' ? 2.5 : 2} /><span className="text-[10px] font-bold">花費</span></button>
                        <button onClick={() => setActiveTab('ai')} className={`flex flex-col items-center gap-1 transition min-w-[50px] ${activeTab === 'ai' ? 'text-blue-600 scale-105' : 'text-slate-400'}`}><Icon name="MessageSquare" size={24} strokeWidth={activeTab === 'ai' ? 2.5 : 2} /><span className="text-[10px] font-bold">助手</span></button>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>